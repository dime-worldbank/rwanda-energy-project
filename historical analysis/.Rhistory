}
data_path <- file.path(
DROPBOX, "Rwanda Energy/datawork/Historical data"
)
usage_1 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_1.xlsx"))
View(usage_1)
usage_2 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_2.xlsx"))
analysis_2011_sector <- nisr_2011 %>%
group_by(sector_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(S14CA + S14CB + S14CC + S14CD),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
library----
pacman::p_load(tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, haven, stringr)
pacman::p_load(tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, haven, stringr)
#read file----
if (Sys.getenv("USERNAME") == "wb614406"){
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
}
data_path <- file.path(
DROPBOX, "Rwanda Energy/datawork/Historical data"
)
nisr_2011 <- read_sav(file.path(data_path, "2011", "rec-2011-data-v2.sav"))
nisr_2014 <- read_sav(file.path(data_path, "2014", "rec-2014-data-v2.sav"))
nisr_2017 <- read_dta(file.path(data_path, "2017", "data-rwa-nisr-ec-2017_stata.dta"))
nisr_2020 <- read_dta(file.path(data_path, "2020", "Data-rwa-nisr-ec-2020_stata.dta"))
nisr14_sector<- read_xlsx(file.path(data_path, "Sector2014.xlsx"))
nisr17_sector <- read_xlsx(file.path(data_path, "Sector2017.xlsx"))
nisr20_sector <- read_xlsx(file.path(data_path, "Sector2020.xlsx"))
#Village_id for establishment 2014
nisr_2014$Village_ID <- substr(nisr_2014$key, 1, 8)
nisr_2014 <- nisr_2014 %>%
select(Village_ID, everything())
nisr_2011 <- nisr_2011 %>%
mutate(Village_ID = ID1*10000000 + ID2*1000000 + ID3*10000 + ID4*100 +ID5) %>%
select(Village_ID, everything())
n_distinct(nisr_2011$Village_ID)
nisr_2011 <- nisr_2011 %>%
mutate(sector_ID = ID1*1000 + ID2*100 + ID3 ) %>%
select(sector_ID, everything())
analysis_2011_sector <- nisr_2011 %>%
group_by(sector_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(S14CA + S14CB + S14CC + S14CD),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
analysis_2011_village <- nisr_2011 %>%
group_by(Village_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(S14CA + S14CB + S14CC + S14CD),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
analysis_2011_village <- nisr_2011 %>%
group_by(Village_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(S14CA + S14CB + S14CC + S14CD),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
View(analysis_2011_sector)
View(analysis_2011_village)
View(nisr_2011)
analysis_2011_village <- nisr_2011 %>%
group_by(Village_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(Total_emp2),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
analysis_2011_village <- nisr_2011 %>%
group_by(Village_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(ifelse(Total_emp2 != 999999, Total_emp2, 0)),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),
local_npo = sum(S05 == 8, na.rm = TRUE),
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
analysis_2011_sector <- nisr_2011 %>%
group_by(sector_ID) %>%
summarize(
num_establishments = n(),
total_worker = sum(ifelse(Total_emp2 != 999999, Total_emp2, 0)),
within_market = sum(S03 == 1, na.rm = TRUE),
outside_market = sum(S03 == 2, na.rm = TRUE),
status_working = sum(S04 == 1, na.rm = TRUE),
status_temp_closed = sum(S04 == 2, na.rm = TRUE),
status_perm_closed = sum(S04 == 3, na.rm = TRUE),
household_sector = sum(S05 == 1, na.rm = TRUE),
private_sector = sum(S05 == 2, na.rm = TRUE),
public_sector = sum(S05 == 3, na.rm = TRUE),
mixed_sector = sum(S05 == 4, na.rm = TRUE),
cooperative_sector = sum(S05 == 5, na.rm = TRUE),
private_education_institution = sum(S05 == 6, na.rm = TRUE),
private_health_institution = sum(S05 == 7, na.rm = TRUE),  # Fixed this line
local_npo = sum(S05 == 8, na.rm = TRUE),  # Fixed this line
IO = sum(S05 == 9, na.rm = TRUE),
head_office = sum(S15 == 1, na.rm = TRUE),
single_unit_establishment = sum(S15 == 2, na.rm = TRUE),
branch_national_enterprise = sum(S15 == 3, na.rm = TRUE),
branch_international_enterprise = sum(S15 == 4, na.rm = TRUE)
)
analysis_2011_sector %>%
summarise(across(everything(), var, na.rm = TRUE))
var(analysis_2011_sector$num_establishments)
var(analysis_2011_village$num_establishments)
var(analysis_2011_village$total_worker)
var(analysis_2011_sector$total_worker)
sector_variance <- analysis_2011_sector %>%
summarise(across(everything(), var, na.rm = TRUE))
village_variance <- analysis_2011_village %>%
summarise(across(everything(), var, na.rm = TRUE))
View(sector_variance)
sector_variance <- sector_variance %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "variance"
)
sector_variance <- analysis_2011_sector %>%
summarise(across(everything(), var, na.rm = TRUE))
sector_variance <- sector_variance %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "sector_variance"
)
village_variance <- village_variance %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "village_variance"
)
variance <- left_join(sector_variance, village_variance, by = c("category"))
View(variance)
variance <- variance %>%
filter(catogry != "sector_ID")
variance <- variance %>%
filter(catogory != "sector_ID")
variance <- variance %>%
filter(category != "sector_ID")
write_xlsx(variance, path = file.path(data_path, "nisr_2011_variance.xlsx"))
write_xlsx(variance, path = file.path(data_path, "nisr_2011_variance.xlsx"))
var(analysis_2011_village$total_worker)
var(analysis_2011_sector$total_worker)
View(usage_1)
usage_1 <- usage_1 %>%
mutate(
District = str_to_title(District),
Sector = str_to_title(Sector),
Cell = str_to_title(Cell),
Village = str_to_title(Village)
)
View(usage_2)
sum(usage$Village == "--")/ nrow()
sum(usage_1$Village == "--")/ nrow()
sum(usage_1$Village == "--")/ nrow(usage_1)
sum(usage_1$Village == "--")
is.na(usage_1$Village == "--")
sum(usage_1$Village == "--")
usage_1 <- usage_1 %>%
mutate(
Village = ifelse(Village %in% c("--"), NA, Village)
)
sd(analysis_2011_sector$total_worker)
sd(analysis_2011_village$total_worker)
sd(analysis_2011_sector$total_worker)
sd(analysis_2011_village$total_worker)
sector_sd <- analysis_2011_sector %>%
summarise(across(everything(), sd, na.rm = TRUE))
village_sd <- analysis_2011_village %>%
summarise(across(everything(), sd, na.rm = TRUE))
sd(analysis_2011_sector$total_worker)
sector_sd <- sector_sd %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "sector_sd"
)
village_sd <- village_sd %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "village_sd"
)
sd <- left_join(sector_sd, village_sd, by = c("category"))
sd <- sd %>%
filter(category != "sector_ID")
View(sd)
sector_sd <- analysis_2011_sector %>%
summarise(across(everything(), sd/mean, na.rm = TRUE))
sd <- sd %>%
mutate(sector_z = (sector_sd - mean(village_sd + sector_sd)) / sd(ends_with("sd")),
village_z = (village_sd - mean(village_sd + sector_sd)) / sd(ends_with("sd")))
sd <- sd %>%
mutate(sector_z = (sector_sd - mean(village_sd + sector_sd)) / sd(select(., ends_with("sd"))),
village_z = (village_sd - mean(village_sd + sector_sd)) / sd(select(., ends_with("sd"))))
library(dplyr)
sd <- sd %>%
mutate(sector_z = (sector_sd - mean(c(village_sd, sector_sd))) / sd(unlist(select(., ends_with("sd")))),
village_z = (village_sd - mean(c(village_sd, sector_sd))) / sd(unlist(select(., ends_with("sd")))))
sd <- sd %>%
mutate(sector_z = (sector_sd - mean(c(village_sd, sector_sd))) / sd(unlist(select(., ends_with("sd")))),
village_z = (village_sd - mean(c(village_sd, sector_sd))) / sd(unlist(select(., ends_with("sd")))))
sd$sd_all <- apply(sd, 1, sd)
sd <- left_join(sector_sd, village_sd, by = c("category"))
sd <- sd %>%
filter(category != "sector_ID")
sd_row <- sd %>%
select(ends_with("sd"))
View(sector_sd)
View(sd_row)
sd_row$sd_all <- apply(sd_row, 1, sd)
sd <- bind_cols(sd, sd_row)
sd <- left_join(sector_sd, village_sd, by = c("category"))
sd <- sd %>%
filter(category != "sector_ID")
sd_row <- sd %>%
select(ends_with("sd"))
sd_row$sd_all <- apply(sd_row, 1, sd)
sd_all <- sd_row$sd_all
sd <- bind_cols(sd, sd_all)
sd <- sd %>%
rename(sd_both = "...4") %>%
mutate(
sector_z = (sector_sd - mean(c(village_sd, sector_sd))) / sd_both,
village_z = (village_sd - mean(c(village_sd, sector_sd))) / sd_both
)
sector_cv <- analysis_2011_sector %>%
summarise(across(everything(), sd/mean, na.rm = TRUE))
sector_cv <- analysis_2011_sector %>%
summarise(across(everything(), ~ (sd(.)/mean(.)) * 100, na.rm = TRUE))
sector_cv <- analysis_2011_sector %>%
select(-sector_ID) %>%
summarise(across(everything(), ~ (sd(.)/mean(.)) * 100, na.rm = TRUE))
sector_cv <- analysis_2011_sector %>%
summarise(across(everything(), (sd(.)/mean(.)) * 100, na.rm = TRUE))
sector_cv <- analysis_2011_sector %>%
summarise(across(everything(), (sd(.)/mean(.)) * 100, na.rm = TRUE))
sector_cv <- analysis_2011_sector %>%
summarise(across(everything(), ~ (sd(.)/mean(., na.rm = TRUE)) * 100))
View(sector_cv)
village_cv <- analysis_2011_village %>%
summarise(across(everything(), ~ (sd(.)/mean(., na.rm = TRUE)) * 100))
sector_cv <- sector_cv %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "sector_cv"
)
village_cv <- village_cv %>%
pivot_longer(
cols = everything(),
names_to = "category",
values_to = "village_cv"
)
sd <- left_join(sd, sector_cv, by = c("category"))
sd <- left_join(sd, village_cv, by = c("category"))
sd <- left_join(sector_sd, village_sd, by = c("category"))
sd <- left_join(sd, sector_cv, by = c("category"))
sd <- left_join(sd, village_cv, by = c("category"))
sd <- sd %>%
filter(category != "sector_ID")
write_xlsx(sd, path = file.path(data_path, "nisr_2011_sd&cv.xlsx"))
usage_1 <- usage_1 %>%
mutate(
Village = ifelse(Village %in% c("--"), NA, Village),
Cell = ifelse(Village %in% c("--"), NA, Cell),
Sector = ifelse(Village %in% c("--"), NA, Sector)
)
usage_1 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_1.xlsx"))
usage_1 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_1.xlsx"))
usage_2 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_2.xlsx"))
#usage_1 clean----
usage_1 <- usage_1 %>%
mutate(
District = str_to_title(District),
Sector = str_to_title(Sector),
Cell = str_to_title(Cell),
Village = str_to_title(Village)
)
usage_1 <- usage_1 %>%
mutate(
Village = ifelse(Village %in% c("--"), NA, Village),
Cell = ifelse(Cell %in% c("--"), NA, Cell),
Sector = ifelse(Sector %in% c("--"), NA, Sector)
)
usage_1 <- read_xlsx(path = file.path(data_path, "EUCL cons usage_1.xlsx"))
usage_1_clean <- usage_1 %>%
mutate(
District = str_to_title(District),
Sector = str_to_title(Sector),
Cell = str_to_title(Cell),
Village = str_to_title(Village)
)
usage_1_clean <- usage_1_clean %>%
mutate(
Village = ifelse(Village %in% c("--"), NA, Village),
Cell = ifelse(Cell %in% c("--"), NA, Cell),
Sector = ifelse(Sector %in% c("--"), NA, Sector)
)
View(usage_1_clean)
View(usage_1)
sum(is.na(Village)/ nrow())
sum(is.na(usage_1_clean$Village)/ nrow())
sum(is.na(usage_1_clean$Village)/ nrow(usage_1_clean))
sum(is.na(usage_1_clean$Village)/ nrow(usage_1_clean))
sum(is.na(usage_1_clean$Sector)/ nrow(usage_1_clean))
sum(is.na(usage_1_clean$Cell)/ nrow(usage_1_clean))
usage_2_clean <- usage_2 %>%
mutate(
District = str_to_title(District),
Sector = str_to_title(Sector),
Cell = str_to_title(Cell),
Village = str_to_title(Village)
)
usage_2_clean <- usage_2_clean %>%
mutate(
Village = ifelse(Village %in% c("--"), NA, Village),
Cell = ifelse(Cell %in% c("--"), NA, Cell),
Sector = ifelse(Sector %in% c("--"), NA, Sector)
)
sum(is.na(usage_1_clean$Village + is.na(usage_2_clean$Village))/ (nrow(usage_1_clean)+ nrow(usage_2_clean)))
sum(is.na(usage_1_clean$Village) + is.na(usage_2_clean$Village))/ (nrow(usage_1_clean)+ nrow(usage_2_clean)))
sum(is.na(usage_1_clean$Village) + is.na(usage_2_clean$Village))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
sum(is.na(usage_2_clean$Village)/ nrow(usage_2_clean))
sum(is.na(usage_1_clean$Village) + is.na(usage_2_clean$Village))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
usage_2_test <- usage_2_clean %>%
filter(is.na(Sector))
if (all(is.na(usage_2_test$Cell) )) {
print("No Violations found:")
} else {
print("Violations found.")
}
View(usage_2_test)
if (all(is.na(usage_2_test$Village) )) {
print("No Violations found:")
} else {
print("Violations found.")
}
usage_2_test <- usage_2_clean %>%
filter(is.na(Cell))
if (all(is.na(usage_2_test$Village) )) {
print("No Violations found:")
} else {
print("Violations found.")
}
sum(is.na(usage_1_clean$Village) + is.na(usage_2_clean$Village))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
sum(is.na(usage_1_clean$Cell) + is.na(usage_2_clean$Cell))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
sum(is.na(usage_1_clean$Sector) + is.na(usage_2_clean$Sector))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
sum(is.na(usage_1_clean$District) + is.na(usage_2_clean$District))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
[sum(is.na(usage_1_clean$Village)) + sum(is.na(usage_2_clean$Village))]/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
(sum(is.na(usage_1_clean$Village)) + sum(is.na(usage_2_clean$Village)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
(sum(is.na(usage_1_clean$Cell)) + sum(is.na(usage_2_clean$Cell)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
(sum(is.na(usage_1_clean$Sector)) + sum(is.na(usage_2_clean$Sector)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
(sum(is.na(usage_1_clean$District)) + sum(is.na(usage_2_clean$District)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
village_missing <- (sum(is.na(usage_1_clean$Village)) + sum(is.na(usage_2_clean$Village)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
cell_missing <- (sum(is.na(usage_1_clean$Cell)) + sum(is.na(usage_2_clean$Cell)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
sector_missing <- (sum(is.na(usage_1_clean$Sector)) + sum(is.na(usage_2_clean$Sector)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
district_missing <- (sum(is.na(usage_1_clean$District)) + sum(is.na(usage_2_clean$District)))/ (nrow(usage_1_clean)+ nrow(usage_2_clean))
year <- usage_1_clean %>%
select(ends_with"Usage(Kwh)")
year <- usage_1_clean %>%
select(ends_with("Usage(Kwh)"))
View(year)
year <- year %>%
rowwise() %>%
mutate(start = names(.)[which.min(c_across() == 0)])
year <- year %>%
rowwise() %>%
mutate(start = names(.)[which.min(c_across != 0)])
year <- year %>%
mutate(start = names(.)[which.min(c_across != 0)])
year <- year %>%
mutate(
everything() = across(everything(), as.numeric(.))
year <- year %>%
mutate(
across(everything(), as.numeric)
)
year <- year %>%
rowwise() %>%
mutate(start = names(.)[which.min(c_across() != 0)])
year <- year %>%
mutate(
across(everything(), ifelse(. = "0.0", NA, .))
)
year <- year %>%
mutate(
across(everything(), ~ ifelse(. == "0.0", NA, .))
)
year <- year %>%
mutate(
across(everything(), ~ ifelse(. == 0.0, NA, .))
)
year$first <- apply(df,1,function(x) names(which(which(!is.na(x))>3))[1])
year$first <- apply(year,1,function(x) names(which(which(!is.na(x))>3))[1])
year$year_first <- substr(year$first, 1:4)
year$year_first <- substr(year$first, 1, 4)
usage_1_clean$year_first <- year$year_first
condition <- all(df$year_first <= df$`Meter installed year`)
condition <- all(usage_1_clean$year_first <= usage_1_clean$`Meter installed year`)
Check the result
if (condition) {
print("All values in year_first are less than or equal to Meter Installed year.")
} else {
print("There are some values in year_first that are greater than Meter Installed year.")
}
