)  %>%
filter(year == 2012) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
)
rwa_bt_selec <- rwa_bt %>%
select(
cell_id, status, n_firms, turnover, turnover95, purchases, purchases95, tax_due, tax_due95
)
rwa_bt_selec <- rwa_bt_selec %>%
mutate(
cell_id = as.numeric(cell_id)
)
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_wtax.dta"))
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_wtax.dta"))
rwa_bt <- rwa_regress %>%
mutate(
status = case_when(
year_first <= 2011 ~ "always_elec",
year_first <= 2014 & year_first >= 2012 ~ "elec12_14",
year_first <= 2017 & year_first >= 2015 ~ "elec15_17",
year_first <= 2020 & year_first >= 2018 ~ "elec18_20",
year_first <= 2022 & year_first >= 2021 ~ "elec21_22",
year_first == 2300 | is.na(year_first) ~ "never_elec"
)
)  %>%
filter(year == 2012) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
) %>%
mutate(
purchaes = as.numeric(purchases),
purchases95 = as.numeric(purchases95)
)
rwa_bt_selec <- rwa_bt %>%
select(
cell_id, status, n_firms, turnover, turnover95, purchases, purchases95, tax_due, tax_due95
)
rwa_bt_selec <- rwa_bt_selec %>%
mutate(
cell_id = as.numeric(cell_id)
)
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_wtax.dta"))
rwa_bt_selec <- rwa_bt %>%
select(cell_id, status, n_firms, turnover, turnover95, purchases, purchases95, tax_due, tax_due95) %>%
filter(is.na(purchases))
# Check if all other variables are NA when purchases is NA
all_na_check <- rwa_bt_selec %>%
mutate(all_na = if_else(is.na(turnover) & is.na(turnover95) & is.na(purchases95) & is.na(tax_due) & is.na(tax_due95) & is.na(n_firms) & is.na(status), TRUE, FALSE))
# View the results
table(all_na_check$all_na)
rwa_bt <- rwa_regress %>%
mutate(
status = case_when(
year_first <= 2011 ~ "always_elec",
year_first <= 2014 & year_first >= 2012 ~ "elec12_14",
year_first <= 2017 & year_first >= 2015 ~ "elec15_17",
year_first <= 2020 & year_first >= 2018 ~ "elec18_20",
year_first <= 2022 & year_first >= 2021 ~ "elec21_22",
year_first == 2300 | is.na(year_first) ~ "never_elec"
)
)  %>%
filter(year == 2012) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
) %>%
mutate(
purchaes = as.numeric(purchases),
purchases95 = as.numeric(purchases95)
)
rwa_bt_selec <- rwa_bt %>%
select(
cell_id, status, n_firms, turnover, turnover95, purchases, purchases95, tax_due, tax_due95
)
rwa_bt_selec <- rwa_bt_selec %>%
mutate(
cell_id = as.numeric(cell_id)
)
filter <- rwa_bt_selec %>% filter(purchases >0)
View(filter)
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_wtax.dta"))
rwa_bt <- rwa_regress %>%
mutate(
status = case_when(
year_first <= 2011 ~ "always_elec",
year_first <= 2014 & year_first >= 2012 ~ "elec12_14",
year_first <= 2017 & year_first >= 2015 ~ "elec15_17",
year_first <= 2020 & year_first >= 2018 ~ "elec18_20",
year_first <= 2022 & year_first >= 2021 ~ "elec21_22",
year_first == 2300 | is.na(year_first) ~ "never_elec"
)
)  %>%
filter(year == 2011)
rwa_bt_selec <- rwa_bt %>%
select(
cell_id, status, num_establishment, total_employee
)
rwa_bt_selec <- rwa_bt_selec %>%
mutate(
cell_id = as.numeric(cell_id)
)
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_2011ec.dta"))
summary_stats <- rwa_regress %>%
group_by(year) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
) %>%
summarize(
turnover_mean = mean(turnover, na.rm = TRUE),
turnover95 = mean(turnover95, na.rm = TRUE),
purchases_mean = mean(purchases, na.rm = TRUE),
purchases95 = mean(purchases95, na.rm = TRUE),
tax_due_mean = mean(tax_due, na.rm = TRUE),
tax_due95 = mean(tax_due95, na.rm = TRUE),
n_firms = sum(n_firms, na.rm = TRUE),
n_real_regime_firms = sum(n_real_regime_firms, na.rm = TRUE),
n_act_firms = sum(n_act_firms, na.rm = TRUE)
) %>%
filter(year != 2010 & year !=2011)
summary_stats <- rwa_regress %>%
group_by(year) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
) %>%
summarize(
turnover_mean = mean(turnover, na.rm = TRUE),
turnover95 = mean(turnover95, na.rm = TRUE),
purchases_mean = mean(purchases, na.rm = TRUE),
purchases95 = mean(purchases95, na.rm = TRUE),
tax_due_mean = mean(tax_due, na.rm = TRUE),
tax_due95 = mean(tax_due95, na.rm = TRUE),
n_firms = sum(n_firms, na.rm = TRUE),
n_real_regime_firms = sum(n_real_regime_firms, na.rm = TRUE),
n_act_firms = sum(n_act_firms, na.rm = TRUE)
) %>%
filter(year != 2010 & year !=2011)
latex_table <- summary_stats %>%
kbl(booktabs = TRUE, format = "latex", caption = "Summary Statistics for 2012-2022") %>%
kable_styling(latex_options = c("hold_position", "striped"))
# Print the LaTeX code
print(latex_table)
rwa_tax <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year > 2012) %>%
mutate(
n_firms = ifelse(is.na(n_firms), 0, n_firms),
turnover = ifelse(is.na(turnover), 0, turnover),
turnover95 = ifelse(is.na(turnover95), 0, turnover95),
purchases = ifelse(is.na(purchases), 0, purchases),
purchases95 = ifelse(is.na(purchases95), 0, purchases95),
tax_due = ifelse(is.na(tax_due), 0, tax_due),
tax_due95 = ifelse(is.na(tax_due95), 0, tax_due95)
)
###n_firms
rwa_tax_log <- rwa_tax %>%
filter(n_firms != 0 & !is.na(n_firms))
n_firms_model <- felm( log(n_firms) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_reg )
summary(n_firms_model)
rwa_tax_log <- rwa_tax %>%
filter(turnover != 0 & !is.na(turnover))
turnover_model <- felm( log(turnover) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(turnover_model)
###turnover95
rwa_tax_log <- rwa_tax %>%
filter(turnover95 != 0 & !is.na(turnover95))
turnover95_model <-  felm( log(turnover95) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(turnover95_model)
rwa_tax_log <- rwa_tax %>%
filter(purchases != 0 & !is.na(purchases))
purchases_model <-  felm( log(purchases) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(purchases_model)
rwa_did <- rwa_regress %>%
mutate(
electrified = case_when(
year_first > year ~ 0,
year_first <= year ~ 1
)
) %>%
mutate(electrified = ifelse(is.na(electrified), 0, electrified)) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 10000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
)
rwa_tax <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)
###n_firms
rwa_tax_log <- rwa_tax %>%
filter(n_firms != 0 & !is.na(n_firms))
n_firms_model <- felm( log(n_firms) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_reg )
summary(n_firms_model)
rwa_tax_log <- rwa_tax %>%
filter(turnover != 0 & !is.na(turnover))
turnover_model <- felm( log(turnover) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(turnover_model)
rwa_tax_log <- rwa_tax %>%
filter(turnover95 != 0 & !is.na(turnover95))
turnover95_model <-  felm( log(turnover95) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(turnover95_model)
rwa_tax_log <- rwa_tax %>%
filter(purchases != 0 & !is.na(purchases))
purchases_model <-  felm( log(purchases) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(purchases_model)
###purchases95
rwa_tax_log <- rwa_tax %>%
filter(purchases95 != 0 & !is.na(purchases))
purchases95_model <-  felm( log(purchases95) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(purchases95_model)
summary(purchases95_model)
rwa_tax_log <- rwa_tax %>%
filter(purchases95 != 0 & !is.na(purchases))
purchases95_model <-  felm( log(purchases95) ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(purchases95_model)
sum(is.na(rwa_tax$electrified))
table(rwa_tax$electrified)
sum(rwa_tax$n_firm[electrified ==1])
sum(rwa_tax$n_firms[electrified == 1])
sum(rwa_tax$n_firms[rwa_tax$electrified == 1])
sum(rwa_tax$n_firms[rwa_tax$electrified == 1], na.rm = TRUE)
sum(rwa_tax$n_firms[rwa_tax$electrified == 0], na.rm = TRUE)
mean(rwa_tax$n_firms[rwa_tax$electrified == 1], na.rm = TRUE)
mean(rwa_tax$n_firms[rwa_tax$electrified == 0], na.rm = TRUE)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases_95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
)
n_firms_model <- felm( n_firms_log ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_reg )
summary(n_firms_model)
n_firms_model <- felm( n_firms_log ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(n_firms_model)
View(rwa_tax_log)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
) %>%
mutate(
n_firms_log = ifelse(n_firms_lot == -Inf, NA, n_firms_log)
)
rwa_bt <- rwa_regress %>%
mutate(
status = case_when(
year_first <= 2011 ~ "always_elec",
year_first <= 2014 & year_first >= 2012 ~ "elec12_14",
year_first <= 2017 & year_first >= 2015 ~ "elec15_17",
year_first <= 2020 & year_first >= 2018 ~ "elec18_20",
year_first <= 2022 & year_first >= 2021 ~ "elec21_22",
year_first == 2300 | is.na(year_first) ~ "never_elec"
)
)  %>%
filter(year == 2012) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 1000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
) %>%
mutate(
purchaes = as.numeric(purchases),
purchases95 = as.numeric(purchases95)
)
rwa_bt_selec <- rwa_bt %>%
select(
cell_id, status, n_firms, turnover, turnover95, purchases, purchases95, tax_due, tax_due95
)
rwa_bt_selec <- rwa_bt_selec %>%
mutate(
cell_id = as.numeric(cell_id)
) %>%
complete(village_id, year, fill = list(n = 0, total_employee = 0, total_manager = 0, total_owner = 0)) %>%
#   mutate(year = 2011) %>%
#   mutate(village_id = as.character(village_id))
#
write_dta(rwa_bt_selec, path = file.path(data_path, "Establishment census", "balance_table_wtax.dta"))
rwa_did <- rwa_regress %>%
mutate(
electrified = case_when(
year_first > year ~ 0,
year_first <= year ~ 1
)
) %>%
mutate(electrified = ifelse(is.na(electrified), 0, electrified)) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 10000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
)
##Difference in differences
rwa_tax <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)
# %>%
#   mutate(
#     n_firms = ifelse(is.na(n_firms), 0, n_firms),
#     turnover = ifelse(is.na(turnover), 0, turnover),
#     turnover95 = ifelse(is.na(turnover95), 0, turnover95),
#     purchases = ifelse(is.na(purchases), 0, purchases),
#     purchases95 = ifelse(is.na(purchases95), 0, purchases95),
#     tax_due = ifelse(is.na(tax_due), 0, tax_due),
#     tax_due95 = ifelse(is.na(tax_due95), 0, tax_due95)
#   )
###NTL Value
ntl_model <- felm( value ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(ntl_model)
###n_firms
n_firms_model <- felm( n_firms ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(n_firms_model)
###turnover
turnover_model <- felm( turnover ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(turnover_model)
###turnover95
turnover95_model <-  felm( turnover95 ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(turnover95_model)
###purchases
purchases_model <-  felm( purchases ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(purchases_model)
###purchases95
purchases95_model <-  felm( purchases95 ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(purchases95_model)
###tax_due
tax_due_model <-  felm( tax_due ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(tax_due_model)
###tax_due95
tax_due95_model <-  felm( tax_due95 ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax )
summary(tax_due95_model)
village_list <- list(
`nightlight` = ntl_model,
`n_firms` = n_firms_model,
`turnover` = turnover_model,
`turnover95` = turnover95_model,
`purchases` = purchases_model,
`purchases95` = purchases95_model,
`tax_due` = tax_due_model,
`tax_due95` = tax_due95_model
)
stargazer(
village_list,
title = "Years 2012-2021",
stars = TRUE,
note = "Exclude villages that are electrified before 2011, Exclude districts Ngororero, Nyabihu, Nyamasheke, Rubavu"
)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
) %>%
mutate(
n_firms_log = ifelse(n_firms_log == -Inf, NA, n_firms_log)
)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
) %>%
mutate(
n_firms_log = ifelse(n_firms_log == -Inf, NA, n_firms_log)
)
n_firms_model <- felm( n_firms_log ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(n_firms_model)
rwa_tax_log <- rwa_did %>%
filter(year_first > 2010) %>%
filter(year >= 2012)%>%
mutate(
n_firms_log = log(n_firms),
turnover_log = log(turnover),
turnover95_log = log(turnover95),
purchases_log = log(purchases),
purchases95_log = log(purchases95),
tax_due_log = log(tax_due),
tax_due95_log = log(tax_due95)
) %>%
mutate(
n_firms_log = ifelse(n_firms_log == -Inf, NA, n_firms_log),
turnover_log = ifelse(turnover_log == -Inf, NA, turnover_log),
turnover95_log = ifelse(turnover95_log == -Inf, NA, turnover95_log),
purchases_log = ifelse(purchases_log == -Inf, NA, purchases_log),
purchases95_log = ifelse(purchases95_log == -Inf, NA, purchases95_log),
tax_due_log = ifelse(tax_due_log == -Inf, NA, tax_due_log),
tax_due95_log = ifelse(tax_due95_log == -Inf, NA, tax_due95_log)
)
n_firms_model <- felm( n_firms_log ~  electrified  | cell_id + year, cluster = "cell_id", data = rwa_tax_log )
summary(n_firms_model)
n_firms_model <- felm(n_firms_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(n_firms_model)
turnover_model <- felm(turnover_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(turnover_model)
turnover95_model <- felm(turnover95_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(turnover95_model)
purchases_model <- felm(purchases_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(purchases_model)
purchases95_model <- felm(purchases95_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(purchases95_model)
tax_due_model <- felm(tax_due_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(tax_due_model)
tax_due95_model <- felm(tax_due95_log ~ electrified | cell_id + year, cluster = "cell_id", data = rwa_tax_log)
summary(tax_due95_model)
village_list <- list(
`n_firms` = n_firms_model,
`turnover` = turnover_model,
`turnover95` = turnover95_model,
`purchases` = purchases_model,
`purchases95` = purchases95_model,
`tax_due` = tax_due_model,
`tax_due95` = tax_due95_model
)
stargazer(
village_list,
title = "Years 2012-2021",
stars = TRUE,
note = "Exclude villages that are electrified before 2011, Exclude districts Ngororero, Nyabihu, Nyamasheke, Rubavu"
)
rwa_poisson <- rwa_regress %>%
mutate(
electrified = case_when(
year_first > year ~ 0,
year_first <= year ~ 1
)
) %>%
mutate(electrified = ifelse(is.na(electrified), 0, electrified)) %>%
filter(!district %in% c("Ngororero", "Nyabihu", "Nyamasheke", "Rubavu")) %>%
mutate(
turnover = turnover / 1000000,
turnover95 = turnover95 / 10000000,
purchases = purchases / 1000000,
purchases95 = purchases95 / 1000000,
tax_due = tax_due / 1000000,
tax_due95 = tax_due95 / 1000000
)
n_firms_model <- glm(n_firms ~ electrified | cell_id + year, data=rwa_poisson, family=poisson())
model <- fepois(n_firms ~ electrified | year, data = rwa_poisson)
?glm()
