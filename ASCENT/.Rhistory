group_by(`Number of Establishment`) %>%
summarise(n = n()) %>%
arrange(n)
ggplot(isic_capital2_establishment, aes(x = `Number of Establishment`, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = `Number of Establishment`, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant Establishment by cell\n Capital level 2&3&4 (more than 15.000.000) ", x = "Number of Establishment", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
ggplot(isic_capital2_establishment, aes(x = `Number of Establishment`, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = `Number of Establishment`, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant Establishment by cell\n Capital level 2&3&4 (more than 500.000) ", x = "Number of Establishment", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
ggplot(isic_capital1_employee, aes(x = total_employee, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = total_employee, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant employee by cell\n Capital level 1&2 (less than 15.000.000)\n winsorized at 100 ", x = "Number of employee", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
ggplot(isic_capital1_employee, aes(x = total_employee, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = total_employee, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant employee by cell\n Capital level 1 (less than 500.000)\n winsorized at 100 ", x = "Number of employee", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
isic_capital3 <- isic_capital %>%
filter(
employed_capital_group == 3 | employed_capital_group == 4
)%>%
group_by( Province, District, Sector, Cell, Cell_ID) %>%
summarise(
n = sum(n),
total_employee = sum(total_employee)
) %>%
arrange(
desc(n)
)
isic_capital3_establishment <- isic_capital3 %>%
select(n) %>%
rename(`Number of Restaurant` = n) %>%
group_by(`Number of Restaurant`) %>%
summarise(n = n()) %>%
arrange(n)
ggplot(isic_capital3_establishment, aes(x = `Number of Restaurant`, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = `Number of Establishment`, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant Establishment by cell\n Capital level 3&4 (more than 15 million)", x = "Number of Restaurant", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
ggplot(isic_capital3_establishment, aes(x = `Number of Restaurant`, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = `Number of Restaurant`, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant Establishment by cell\n Capital level 3&4 (more than 15 million)", x = "Number of Restaurant", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
isic_capital3 <- isic_capital %>%
filter(
employed_capital_group == 3 | employed_capital_group == 4 |total_employee > 10
)%>%
group_by( Province, District, Sector, Cell, Cell_ID) %>%
summarise(
n = sum(n),
total_employee = sum(total_employee)
) %>%
arrange(
desc(n)
)
isic_capital3_establishment <- isic_capital3 %>%
select(n) %>%
rename(`Number of Restaurant` = n) %>%
group_by(`Number of Restaurant`) %>%
summarise(n = n()) %>%
arrange(n)
ggplot(isic_capital3_establishment, aes(x = `Number of Restaurant`, y = n)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
geom_smooth(aes(x = `Number of Restaurant`, y = n), method = "loess", se = FALSE, color = "red") +
labs(title = "Number of Restaurant Establishment by cell\n Capital level 3&4 (more than 15 million)", x = "Number of Restaurant", y = "Frequency") +
theme_minimal() +
theme(
axis.title = element_text(size = 14),  # Increase size of x and y axis labels
axis.text = element_text(size = 12),   # Increase size of x and y axis tick labels
plot.title = element_text(size = 16, hjust = 0.5),  # Increase plot title size and center it
legend.title = element_text(size = 14),  # Increase legend title size (if applicable)
legend.text = element_text(size = 12)    # Increase legend text size (if applicable)
)
write_xlsx(isic_capital3, path = file.path(output_path, "ISIC9_capital3+(cell).xlsx"))
# ec <- read.dta13("datawork/admin_data/Establishment Census/2017/")
# ec <- read.dta13("datawork/admin_data/Establishment Census/2014/data-rwa-nisr-ec-2014_stata.dta")
ec <- read.dta13("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/tempcode/ec2020/EC2020_RTDA_WB.dta")
library(tidyverse)
library(readstata13)
library(foreign)
library(lfe)
# ec <- read.dta13("datawork/admin_data/Establishment Census/2017/")
# ec <- read.dta13("datawork/admin_data/Establishment Census/2014/data-rwa-nisr-ec-2014_stata.dta")
ec <- read.dta13("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/tempcode/ec2020/EC2020_RTDA_WB.dta")
labels <- data.frame(var = names(ec), label = attributes(ec)$var.labels)
# SAMPLE: URBAN RESTAURANTS
ecclean <- ec %>%
filter(q6_1 == "Accommodation and food service activities" & q1_5_1 == "Urban") %>%
rename(nemployees = q18_9, paysvat = q24a, size = size,
dist = q1_2, sect = q1_3_name, cell = q1_4_name)
# ecclean %>%
#   ggplot(aes(x = nemployees, col = paysvat, group = paysvat)) +
#   geom_density(aes(y = ..density..)) +
#   scale_x_log10()
# ecclean %>% count(paysvat)
### CHECKING MOST RESTAURANTS BY DIST/SECT/CELL
counts <- ecclean %>%
group_by(dist, sect, cell) %>%
summarise(ntotal = n(),
ntotalvat = sum(paysvat == "Yes" & nemployees >= 2),
ntotal234 = sum(size %in% c(2, 3, 4) & nemployees >= 2),
nemp10 = sum(nemployees >= 10)) %>%
ungroup
priority <- counts %>%  filter(ntotalvat >= 18)
nonpriority <- counts %>% filter(ntotalvat < 18)
ie <- nonpriority %>% filter(ntotalvat >= 3) %>%
group_by(dist, sect) %>% filter(n() >= 2) %>% ungroup
iealt <- nonpriority %>% filter(ntotalvat >= 2) %>%
group_by(dist, sect) %>% filter(n() >= 2) %>% ungroup
holdout <- nonpriority %>% anti_join(ie)
library(sf)
View(counts)
rwa_village <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/data/rwa_cell/Cell.shp"))
rwa_village <- st_make_valid(rwa_village)
rwa_cell <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/data/rwa_cell/Cell.shp"))
rwa_cell <- st_make_valid(rwa_cell)
View(rwa_cell)
counts <- left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
View(ec)
counts <- counts %>%
mutate(sect = str_as_title(sect)) %>%
left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts <- counts %>%
mutate(sect = str_as_title(sect)) %>%
left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
library(stringr)
counts <- counts %>%
mutate(sect = str_as_title(sect)) %>%
left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts <- counts %>%
mutate(sect = str_to_title(sect)) %>%
left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
rwa_cell <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/data/rwa_cell/Cell.shp"))
rwa_cell <- st_make_valid(rwa_cell)
counts <- counts %>%
mutate(sect = str_to_title(sect)) %>%
left_join(counts, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts <- counts %>%
mutate(sect = str_to_title(sect)) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts <- ecclean %>%
group_by(dist, sect, cell) %>%
summarise(ntotal = n(),
ntotalvat = sum(paysvat == "Yes" & nemployees >= 2),
ntotal234 = sum(size %in% c(2, 3, 4) & nemployees >= 2),
nemp10 = sum(nemployees >= 10)) %>%
ungroup
counts <- counts %>%
mutate(sect = str_to_title(sect)) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, fixed(" I"), " i"),
sect = str_replace_all(sect, fixed(" A"), " a"),
sect = str_replace_all(sect, fixed(" B"), " b"),
sect = ifelse(sect = "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, fixed(" I"), " i"),
sect = str_replace_all(sect, fixed(" A"), " a"),
sect = str_replace_all(sect, fixed(" B"), " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
n_distinct(counts_id$Cell_ID)
View(counts_id)
### CHECKING MOST RESTAURANTS BY DIST/SECT/CELL
counts <- ecclean %>%
group_by(dist, sect, cell) %>%
summarise(ntotal = n(),
ntotalvat = sum(paysvat == "Yes" & nemployees >= 2),
ntotal234 = sum(size %in% c(2, 3, 4) & nemployees >= 2),
nemp10 = sum(nemployees >= 10)) %>%
ungroup
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, fixed(" I"), " i"),
sect = str_replace_all(sect, fixed(" A"), " a"),
sect = str_replace_all(sect, fixed(" B"), " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
n_distinct(counts_id$Cell_ID)
View(counts_id)
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, fixed(" I"), " i"),
sect = str_replace_all(sect, fixed(" A"), " a"),
sect = str_replace_all(sect, fixed(" B"), " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
)
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, " I", " i"),
sect = str_replace_all(sect, " A", " a"),
sect = str_replace_all(sect, " B", " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
grep(" I", counts$sect, value = TRUE)
grep(" A", counts$sect, value = TRUE)
grep("\\bA\\b", counts$sect, value = TRUE)
grep(" l", counts$sect, value = TRUE)
library(tidyverse)
library(readstata13)
library(foreign)
library(lfe)
library(sf)
library(stringr)
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, " I", " i"),
sect = str_replace_all(sect, " A", " a"),
sect = str_replace_all(sect, " B", " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
View(counts_id)
write_xlsx(path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
library(writexl)
library(readxl)
write_xlsx(path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
write_xlsx(counts_id, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, "\\bI\\b", "i"),
sect = str_replace_all(sect, "\\bA\\b", "a"),
sect = str_replace_all(sect, "\\bB\\b", "b"),
sect = ifelse(sect == "Nyamata Y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
?str_replace_all(
)
counts_id <- counts %>%
mutate(
sect = str_replace_all(sect, "Munanira I", "Munanira i"),
sect = str_replace_all(sect, "Munanira Ii", "Munanira ii")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(
sect = str_replace_all(sect, "
Munanira I", "Munanira i"),
sect = str_replace_all(sect, "Munanira Ii", "Munanira ii")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(
sect = str_replace_all(sect, "Munanira I", "Munanira i"),
sect = str_replace_all(sect, "Munanira Ii", "Munanira ii")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
str(counts_id$cell)
counts_id <- counts %>%
mutate(
# Replace any string ending with " I" → " i"
sect = str_replace_all(sect, " I$", " i"),
# Replace any string ending with " Ii" → " ii"
sect = str_replace_all(sect, " Ii$", " ii")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, " I", " i"),
sect = str_replace_all(sect, " A", " a"),
sect = str_replace_all(sect, " B", " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
sect = str_replace_all(sect, " l", " i"),
sect = str_replace_all(sect, " A", " a"),
sect = str_replace_all(sect, " B", " b"),
sect = ifelse(sect == "Nyamata y' Umujyi", "Nyamata y' umujyi", sect)
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- read_xlsx( path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
counts_id <-
left_join(counts_id, rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
n_distinct(counts_id$Cell_ID)
lv_22 <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/Existing Electrical Network_2022/Existing_LVLine.shp"))
electrified_cell <-st_intersection(rwa_cell, lv_22)
lv_22 <- st_transform(lv_22, crs = st_crs(rwa_cell))
electrified_cell <-st_intersection(rwa_cell, lv_22)
View(electrified_cell)
electrified_cell <- electrified_cell %>%
distinct(Cell_ID, .keep_all = TRUE)
electrified_count <- counts_id %>%
filter(!Cell_ID %in% electrified_cell$Cell_ID)
View(electrified_count)
write_xlsx(electrified_count)
write_xlsx(electrified_count, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/not electrified.xlsx"))
write_xlsx(electrified_count, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/Not electrified cell.xlsx"))
write_xlsx(electrified_count, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/Not electrified cell.xlsx"))
write_xlsx(ie, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/IE cell.xlsx"))
write_xlsx(holdout, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/Holdout cell.xlsx"))
write_xlsx(priority, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/Priority cell.xlsx"))
write_xlsx(non_priority, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/None-priority cell.xlsx"))
write_xlsx(nonpriority, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/None-priority cell.xlsx"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
write_xlsx(counts_id, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(sect = str_replace(sect, " I$", " i")) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(sect = str_replace(sect, " I", " i")) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(sect = str_replace(sect, "I", "i")) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
write_xlsx(counts_id, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/count.xlsx"))
rwa_cell <- st_make_valid(rwa_cell) %>%
mutate(
Name = str_to_lower(Name)
)
counts_id <- counts %>%
mutate(sect = str_to_lower(sect)) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
View(counts_id)
rwa_cell <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/data/rwa_cell/Cell.shp"))
rwa_cell <- st_make_valid(rwa_cell)
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
cell = str_replace(cell, " I", " i"),
cell = str_replace(cell, " Ii", " ii"),
cell = str_replace_all(cell, " B", " b"),
cell = str_replace_all(cell, " A", " a"),
cell = str_replace_all(cell, "Nyamata Y' Umujyi", " Nyamata y' umujyi")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
cell = str_replace(cell, " I", " i"),
cell = str_replace(cell, " Ii", " ii"),
cell = str_replace_all(cell, " B", " b"),
cell = str_replace_all(cell, " A", " a"),
cell = str_replace_all(cell, "Nyamata y' Umujyi", " Nyamata y' umujyi")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
View(rwa_cell)
counts_id <- counts %>%
mutate(sect = str_to_title(sect)) %>%
mutate(
cell = str_replace(cell, " I", " i"),
cell = str_replace(cell, " Ii", " ii"),
cell = str_replace_all(cell, " B", " b"),
cell = str_replace_all(cell, " A", " a"),
cell = str_replace_all(cell, "Nyamata y' Umujyi", "Nyamata y' umujyi")
) %>%
left_join(rwa_cell, by = c("cell" = "Name", "sect" = "Sector"))
lv_22 <- st_read(dsn = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/Existing Electrical Network_2022/Existing_LVLine.shp"))
lv_22 <- st_transform(lv_22, crs = st_crs(rwa_cell))
electrified_cell <-st_intersection(rwa_cell, lv_22)
electrified_cell <- electrified_cell %>%
distinct(Cell_ID, .keep_all = TRUE)
electrified_count <- counts_id %>%
filter(!Cell_ID %in% electrified_cell$Cell_ID)
View(electrified_count)
write_xlsx(electrified_count, path = file.path("C:/Users/wb614406/Dropbox/Rwanda Energy/ASCENT/datawork/RCT data/No 2022 LV cell.xlsx"))
sum(ie$ntotal)
View(ie)
pacman::p_load(knitr, lfe,fixest, modelsummary, stargazer, tidyverse, dplyr, here, sf, haven, ggplot2, readxl,  writexl, janitor, randomizr, RCT, purrr, RODBC, DBI)
getwd()
#############
#Author: Xiaoming Zhang
#Date: 03252025
#Topic: Join Sector
###################
pacman::p_load(knitr, lfe,fixest, modelsummary, stargazer, tidyverse, dplyr, here, sf, haven, ggplot2, readxl,  writexl, janitor, randomizr, RCT, purrr, RODBC, DBI)
getwd()
dropbox <- 'C:/Users/wb614406/Dropbox'
data_path <- file.path(
dropbox,
"Rwanda Energy/ASCENT/datawork/data"
)
output_path <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/outputs"
)
target <- read_xlsx(path = file.path(data_path,
"Target_Sectors_ePC.xlsx"))
View(target)
target <- read_xlsx(path = file.path(data_path,
"Target_Sectors_ePC.xlsx"))
target <- target %>%
fiter(
!is.na(...2)
)
target <- target %>%
filter(
!is.na(...2)
)
target <- read_xlsx(path = file.path(data_path,
"Target_Sectors_ePC.xlsx"))
target <- target %>%
filter(
!is.na(...2)
)
target <- target %>%
filter(
!is.na(Sector)
)
target <- target %>%
filter(
!is.na(Sectors)
)
rwa_district <- st_read(dsn = file.path(data_path, rwa_district, District.shp))
rwa_district <- st_read(dsn = file.path(data_path, rwa_district, Districts.shp))
rwa_district <- st_read(dsn = file.path(data_path, rwa_district, "District.shp"))
rwa_district <- st_read(dsn = file.path(data_path, rwa_district, "District.shp"))
rwa_district <- st_read(dsn = file.path(data_path, "rwa_district", "District.shp"))
View(rwa_district)
rwa_sector <- st_read(dsn = file.path(data_path, "rwa_sector", "Sector.shp"))
View(rwa_sector)
rwa_sector <- rwa_sector %>%
st_drop_geometry() %>%
select(Province, District)
target <- left_join(target, rwa_sector, by = c("District"))
target <- read_xlsx(path = file.path(data_path,
"Target_Sectors_ePC.xlsx"))
target <- target %>%
filter(
!is.na(Sectors)
)
target <- left_join(target, rwa_sector, by = c("District" = "District", "Sector" = "Sector"))
target <- left_join(target, rwa_sector, by = c("District" = "District", "Sectors" = "Sector"))
rwa_sector <- st_read(dsn = file.path(data_path, "rwa_sector", "Sector.shp"))
rwa_sector <- rwa_sector %>%
st_drop_geometry() %>%
select(Province, District, Sector)
rwa_sector <- st_read(dsn = file.path(data_path, "rwa_sector", "Sector.shp"))
rwa_sector <- rwa_sector %>%
st_drop_geometry() %>%
select(Province, District, Sect)
rwa_sector <- rwa_sector %>%
st_drop_geometry() %>%
select(Province, District, Name)
target <- left_join(target, rwa_sector, by = c("District" = "District", "Sectors" = "Name"))
target <- target %>%
select(Province, everything())
write_xlsx(target, path = file.path(data_path, "Target_Sectors_ePC_format.xlsx"))
View(target)
View(rwa_sector)
