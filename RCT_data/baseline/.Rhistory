pacman::p_load(tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr)
getwd()
if (Sys.getenv("USERNAME") == "wb614406"){
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
}
#Method One----
path <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/four_district_2401.xlsx"
)
#read file----
four_district_2401 <- read_xlsx(path)
#Method One----
path_off900 <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/Additional Offgrid scope-NEP 2023 Final-Priorities.xlsx"
)
#read file----
offgrid_900 <- read_xlsx(path_off900)
View(offgrid_900)
path_off <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/Offgrid Scope Priorities.xlsx.xlsx"
)
#read file----
offgrid.2<- read_xlsx(path_off900)
offgrid.1<- read_xlsx(path_off)
path_off <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/Offgrid Scope Priorities.xlsx"
)
offgrid.1<- read_xlsx(path_off)
View(offgrid.1)
print("The data frames are different.")
if (all.equal(offgrid.1, offgrid.2)) {
print("The data frames are the same.")
} else {
print("The data frames are different.")
print(all.equal(offgrid.1, offgrid.2))
}
four_district_2401 <- four_district_2401 %>%
mutate(
SAS = ifelse(nep_revision %in% c("SAS", "SAS 2023", "GE_Temporaly SAS", "Microgrid"), "SAS", "non SAS")
)
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
table(three_scope_2401.1$SAS)
four_district_2401.1 <- four_district_2401.1  %>%
mutate(status = case_when(
any_grid == "newly" & any_offgrid == "newly" ~ "newly",
.default = "partial"
))
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(
any_grid = case_when(
grid_status %in% c("newly") & nep_revision%in% c("GE", "Fill In")  ~ "newly",
.default = "partial"
)
)
four_district_2401.1 <- four_district_2401.1  %>%
mutate(status = case_when(
any_grid == "newly" & any_offgrid == "newly" ~ "newly",
.default = "partial"
))
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
#Method One----
path <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/four_district_2401.xlsx"
)
#read file----
four_district_2401 <- read_xlsx(path)
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(
any_grid = case_when(
grid_status %in% c("newly") & nep_revision%in% c("GE", "Fill In")  ~ "newly",
.default = "partial"
)
)
four_district_2401.1 <- four_district_2401.1  %>%
mutate(status = case_when(
any_grid == "newly" & any_offgrid == "newly" ~ "newly",
.default = "partial"
))
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
three_scope_2401.1 <- three_scope_2401.1 %>%
mutate(
status = ifelse(ubudehe_1 <20, "partial", status)
)
table(three_scope_2401.1$status)
no_line <- three_scope_2401 %>%
filter(meter_eucl == 0 & existing_LV == 0 )
pacman::p_load(tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr)
getwd()
no_line <- three_scope_2401 %>%
filter(meter_eucl == 0 & existing_LV == 0 )
View(three_scope_2401.1)
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(
any_grid = case_when(
grid_status %in% c("newly") & nep_revision%in% c("GE", "Fill In")  ~ "newly",
.default = "partial"
)
)
four_district_2401.1 <- four_district_2401.1  %>%
mutate(status = case_when(
any_grid == "newly" & any_offgrid == "newly" ~ "newly",
.default = "partial"
))
four_district_2401.1  <- four_district_2401.1 %>%
mutate(
status = ifelse(ubudehe_1 <20, "partial", status)
)
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
four_district_2401.1 <- four_district_2401.1%>%
mutate(scope_2401 = ifelse(district %in% c("Rutsiro", "Rusizi"), scope_1024, scope_2401))
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
write_xlsx(four_district_2401.1, here("data", "four_district.xlsx"))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(meter_percent = round(meter_eucl/total_hh, 2))
write_xlsx(four_district_2401.1, here("data", "four_district.xlsx"))
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
no_line <- three_scope_2401.1 %>%
filter(meter_eucl == 0 & existing_LV == 0 )
no_line <- three_scope_2401.1 %>%
filter(meter_eucl == 0 & length_lv == 0 )
View(no_line)
no_line <- three_scope_2401.1 %>%
filter(meter_eucl != 0 & length_lv == 0 )
View(no_line)
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
path_noline <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/documentation/meter_no_lv.xlsx"
)
write_xlsx(no_line, path = path_noline)
path_noline <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/documentation/Output Datafiles/meter_no_lv.xlsx"
)
write_xlsx(no_line, path = path_noline)
path_noline <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data/baseline/documentation/meter_no_lv.xlsx"
)
write_xlsx(no_line, path = path_noline)
no_bufferlin <- three_scope_2401.1 %>%
filter(meter_eucl!= 0 & grid_status == "newly")
no_line.1 <- no_line %>%
filter(any_offgrid == "newly")
View(no_line.1)
pacman::p_load(tidyverse, here, readxl)
knitr::opts_chunk$set(echo = TRUE)
d<- 0.2
P<- 0.5
n<-783
z<- 2.8
signma_square <- 1
m<- 54
rho <- (d^2 * n * P * (1 - P) - z^2 * 1) / (z^2 * 1 * (m - 1))
d<- 0.2
P<- 0.5
n<-783
z<- 2.8 #
signma_square <- 1
m<- 54
rho <- (d^2 * n * P * (1 - P) - z^2 * 1) / (z^2 * 1 * (m - 1))
rho
mde <- z * signma * sqrt((1 + rho * (m - 1)) / (n * P * (1 - P)))
mde <- function(m, n, signma, base) {
rho <- rho
z <- 2.80
P <- 0.66
mde <- z * signma * sqrt((1 + rho * (m - 1)) / (n * P * (1 - P)))
return(mde/base)
}
mde <- function(m, n, signma, base) {
rho <- rho
z <- 2.80
P <- 0.66
m <- m*0.75
n <- n*0.75
mde <- z * signma * sqrt((1 + rho * (m - 1)) / (n * P * (1 - P)))
return(mde/base)
}
mde(109, 2180, 1, 1)
mde(68, 2040, 1, 1)
three_scope_2401.1 %>%
filter(ubudehe_1 >- 25)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 25)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 25 & status == "newly" & meter_percent < 25%)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 25 & status == "newly" & meter_percent < 0.25)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 20 & status == "newly" & meter_percent < 0.25)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 30 & status == "newly" & meter_percent < 0.25)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 25 & status == "newly" & meter_percent < 0.25)
mde(85, 2125, 1, 1)
rho <- (d^2 * n * P * (1 - P) - z^2 * signma_square) / (z^2 * signma_square * (m - 1))
mde(85, 2125, 1, 1)
s2 <- (22-0)/1.349
# After calculating the sd of both control and treatment group using their statistics from 2016, and from there calculating the pooled standard deviation for the population.
s2 <- (22-0)/1.349
s1 <- (76.4-30.9)/1.349
n2 <- 506
n1 <- 208
pooled_sd <- sqrt(((n1-1)*s1^2 + (n2-1)*s2^2) / (n1+n1-2))
# - Minimum detectable effect: because we only have the percentile of the data set for treatment(newly connected households in sample), and control(baseline connected households in sample), the effect of the subsidy and connection is imitated through comparing the difference in consumption increase rate for the two groups between 2016-2017 (which is time of the round1 and round2 survey)
# - The formula and result is: (T2017 - T2016)/T2016 - (C2017 - C2016)/C2016 = 0.39
# - Therefore I'm using the increase of 30%, 35%, and 40% for calculating sample size
# - The data could be found on page 101 of the Lee etal. pdf(A-57 in terms of page number)
mde(109, 2180, 21.83, 10.83)
mde(85, 2125, 21.83, 10.83)
mde(68, 2040, 21.83, 10.83)
mde(109, 2180, 2.75, 2.64)
mde(85, 2125, 2.75, 2.64)
mde(68, 2040 2.75, 2.64)
mde(68, 2040, 2.75, 2.64)
mde(109, 2180, 16.31, 7.9)
mde( 85, 2125, 16.31, 7.9)
mde(68, 2040, 16.31, 7.9)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(ubudehe_1 >= 25 & status == "newly" & meter_percent < 0.3)
mde(116, 2320, 1, 1)
mde(90, 2250, 1, 1)
mde(70, 2100, 1, 1)
mde(116, 2320, 21.83, 10.83)
mde(90, 2250, 21.83, 10.83)
mde(70, 2100, 21.83, 10.83)
mde(116, 2320, 2.75, 2.64)
mde(90, 2250, 2.75, 2.64)
mde(70, 2100, 2.75, 2.64)
mde(116, 2320, 16.31, 7.9)
mde(90, 2250, 16.31, 7.9)
mde(70, 2100, 16.31, 7.9)
pacman::p_load(tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr)
getwd()
#Dropbox----
if (Sys.getenv("USERNAME") == "wb614406"){
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
}
#Method One----
path <- file.path(
DROPBOX,
"Rwanda Energy/datawork/RCT_data",
"baseline/data/data/four_district_2401.xlsx"
)
#read file----
four_district_2401 <- read_xlsx(path)
four_district_2401.1 <- four_district_2401 %>%
mutate(any_offgrid = case_when(
et_sum !=0 | priority_0 == 0 ~ "partial",
.default = "newly"
))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(
any_grid = case_when(
grid_status %in% c("newly") & nep_revision%in% c("GE", "Fill In")  ~ "newly",
.default = "partial"
)
)
four_district_2401.1 <- four_district_2401.1  %>%
mutate(status = case_when(
any_grid == "newly" & any_offgrid == "newly" ~ "newly",
.default = "partial"
))
four_district_2401.1  <- four_district_2401.1 %>%
mutate(
status = ifelse(ubudehe_1 <20, "partial", status)
)
four_district_2401.1 <- four_district_2401.1%>%
mutate(scope_2401 = ifelse(district %in% c("Rutsiro", "Rusizi"), scope_1024, scope_2401))
four_district_2401.1 <- four_district_2401.1 %>%
mutate(meter_percent = round(meter_eucl/total_hh, 2))
write_xlsx(four_district_2401.1, here("data", "four_district.xlsx"))
#Karongi+Rutsiro+Rulindo----
three_scope_2401.1 <- four_district_2401.1 %>%
filter(district %in% c("Karongi", "Rulindo", "Rutsiro") & scope_2401 == 1)
table(three_scope_2401.1$status)
three_scope_2401.2 <- three_scope_2401.1 %>%
filter(meter_percent < 0.3 & ubudehe_1 >= 20)
table(three_scope_2401.2$status)
three_scope_2401.2 %>%
group_by(district) %>%
summarise(
village_n = n(),
ubudehe_1 = village_n * 20
)
three_scope_2401.2 %>%
filter(status == "newly")
three_scope_2401.2 %>%
filter(status == "newly") m
three_scope_2401.2 %>%
filter(status == "newly") %>%
group_by(district) %>%
summarise(
village_n = n(),
ubudehe_1 = village_n * 20
)
