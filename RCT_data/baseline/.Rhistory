sum(households$`Approached by Lattanzio` == "Yes")
n_distinct(hfc_constr$hh_id)
households_clean <- households %>%
mutate(
`In Fully Completed village` = ifelse(villageid_key %in% village_finish$villageid_key , "Yes", "No"),
`Dropped from scope due to 15kv` = ifelse(villageid_key%in% rulindo_15kv$Code_vill, "Yes", "No")
)
#Read out 15kv rulindo----
rulindo_15kv <- read_xlsx(path = file.path(scope_path, "Villages falling in 15kV_EPC Rulindo.xlsx"))
# households_clean <- households %>%
#  mutate(case_when(villageid_key %in% rulindo_15kv$Code_vill)
#
# write_xlsx(households_clean, path = file.path(scope_path, "vulnerable households in sample villages.xlsx"))
#Filter finished villages----
village_check <- read_xlsx(path = file.path(scope_path, "HFC_REP_24 (1).xlsx"), sheet = "village_data")
village_finish <- village_check %>%
filter(attempt == hh_head_06 | complete >= 20)
households_clean <- households %>%
mutate(
`In Fully Completed village` = ifelse(villageid_key %in% village_finish$villageid_key , "Yes", "No"),
`Dropped from scope due to 15kv` = ifelse(villageid_key%in% rulindo_15kv$Code_vill, "Yes", "No")
)
write_xlsx(households_clean, path = file.path(scope_path, "vulnerable households in sample villages.xlsx"))
View(households_clean)
sum(households_clean$`Approached by Lattanzio` = "Yes")
sum(households_clean$`Approached by Lattanzio` == "Yes")
write_xlsx(households_clean, path = file.path(scope_path, "vulnerable households in sample villages.xlsx"))
sum(households_clean$`Completed by Lattanzio`== "Yes")
pacman::p_load(knitr, tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr, RCT, purrr)
getwd()
#Dropbox----
if (Sys.getenv("USERNAME") == "wb614406"){
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
}
data_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/data/data"
)
scope_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/data/Updated scope villages& households"
)
output_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/outputs"
)
sum(household_clean$ `Approached by Lattanzio` == Yes)
sum(households_clean$ `Approached by Lattanzio` == Yes)
sum(households_clean$ `Approached by Lattanzio` == "Yes")
sum(households_clean$ `Completed by Lattanzio` == "Yes")
1206/4302
admin_raw <- read.csv(file.path(data_path, "admin_raw.csv"))
View(admin_raw)
admin_raw <- read.csv(file.path(data_path, "admin_raw.csv"))
admin_raw <- admin_raw %>%
select(treatment, villageid_key)
households_clean <- left_join(households_clean, admin_raw, by = c("villageid_key"))
admin_raw <- admin_raw %>%
select(treatment, villageid_key) %>%
mutate(
villageid_key = as.character(villageid_key)
)
households_clean <- left_join(households_clean, admin_raw, by = c("villageid_key"))
View(households_clean)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment %in% C( "T1", "T3")) %>%
group_by(district) %>%
summarise(
complete = sum(`Approached by Lattanzio`),
approached = sum(`Completed by Lattanzio`)
) %>%
mutate(
percent_complete = paste0(round(complete/approach, 4)*100, "%")
)
View(households_clean)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
complete = sum(`Approached by Lattanzio`),
approached = sum(`Completed by Lattanzio`)
) %>%
mutate(
percent_complete = paste0(round(complete/approach, 4)*100, "%")
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
complete = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes")
) %>%
mutate(
percent_complete = paste0(round(complete/approach, 4)*100, "%")
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes")
) %>%
mutate(
percent_complete = paste0(round(completed/approached, 4)*100, "%")
)
View(households_clean_sum)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes")
) %>%
mutate(
percent_complete = paste0(round(approached/completed, 4)*100, "%")
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = paste0(round(approached/completed, 4)*100, "%"),
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = round(approached/completed, 4),
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = round(approached/completed, 2),
estimate_accept = percent_complete*total_households
)
View(admin_raw)
admin_raw <- read.csv(file.path(data_path, "admin_raw.csv"))
View(admin_raw)
treatment_test <- admin_raw %>% group_by(district_key) %>% table(treatment)
treatment_test <- admin_raw %>% group_by(district_key) %>% summarise(T1 = sum(treatment == "T1"), T2 = sum(treatment == "T2"), T3 = sum(treatment == "T3"), C = sum(treatment == "C"))
treatment_test <- admin_raw %>%
group_by(district_key) %>%
summarise(
T1 = sum(treatment == "T1"),
T2 = sum(treatment == "T2"),
T3 = sum(treatment == "T3"),
C  = sum(treatment == "C")
)
View(treatment_test)
households_clean_sum$`proposed readyboard` <- c("224", "221", "224", "1102")
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
group_by(district) %>%
summarise(
completed = sum(`Approached by Lattanzio` == "Yes"),
approached = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = round(approached/completed, 2),
estimate_accept = percent_complete*total_households
)
households_clean_sum$`EDCL proposed readyboard` <- c("224", "221", "224", "1102")
households_clean_sum
data.frame(district = c("KARONGI", "RUTSIRO", "Rulindo", "Rusizi"),
`EDCL proposed readyboard` = c("224", "221", "224", "1102"))
group_by(district) %>%
summarise(
attempted = sum(`Approached by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = completed/attempted,
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
rename(`Attempted by Lattanzio` = `Approached by Lattanzio`) %>%
group_by(district) %>%
summarise(
attempted = sum(`Approached by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
percent_complete = completed/attempted,
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean_sum %>%
left_join(
data.frame(district = c("KARONGI", "RUTSIRO", "Rulindo", "Rusizi"),
`EDCL proposed readyboard` = c("224", "221", "224", "1102"))
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
rename(`Attempted by Lattanzio` = `Approached by Lattanzio`) %>%
group_by(district) %>%
summarise(
attempted = sum(`Approached by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
`completed/attempted` = completed/attempted,
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
rename(`Attempted by Lattanzio` = `Approached by Lattanzio`) %>%
group_by(district) %>%
summarise(
attempted = sum(`Approached by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
`completed/attempted` = completed/attempted,
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
rename(`Attempted by Lattanzio` = `Approached by Lattanzio`) %>%
group_by(district) %>%
summarise(
attempted = sum(`Attempted by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
`completed/attempted` = completed/attempted,
estimate_accept = percent_complete*total_households
)
households_clean_sum <- households_clean %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
filter(treatment ==  "T1" | treatment == "T3") %>%
rename(`Attempted by Lattanzio` = `Approached by Lattanzio`) %>%
group_by(district) %>%
summarise(
attempted = sum(`Attempted by Lattanzio` == "Yes"),
completed = sum(`Completed by Lattanzio` == "Yes"),
total_households = n()
) %>%
mutate(
`completed/attempted` = completed/attempted,
estimate_accept = `completed/attempted`*total_households
)
households_clean_sum <- households_clean_sum %>%
left_join(
data.frame(district = c("KARONGI", "RUTSIRO", "Rulindo", "Rusizi"),
`EDCL proposed readyboard` = c("224", "221", "224", "1102"))
)
pacman::p_load(knitr, tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr, RCT, purrr)
getwd()
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "lot_karongi", "village list"))
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "lot_karongi"), sheet = "village list")
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "Lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "Survey Firm", Lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_scope <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_household <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Karongi.xlsx"), sheet = "household list")
lot_karongi_replacement <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Karongi.xlsx"), sheet = "replacement_household")
karongi <- file.path("C:\Users\wb614406\Downloads\Lot_Karongi.xlsx")
new_karongi_village <- read_xlsx(path = file.path(karongi), sheet = "village list")
karongi <- file.path("C:\Users\wb614406\Downloads\Lot_Karongi.xlsx")
karongi <- file.path("\Users\wb614406\Downloads\Lot_Karongi.xlsx")
new_karongi_village <- read_xlsx(path = "C:\Users\wb614406\Downloads\Lot_Karongi.xlsx", sheet = "village list")
new_karongi_village <- read_xlsx(path = file.path(scope_path, "Survey Firm", "New_Lot_Karongi.xlsx"), sheet = "village list")
new_karongi_household <- read_xlsx(path = file.path(scope_path, "Survey Firm", "New_Karongi.xlsx"), sheet = "household list")
new_karongi_household <- read_xlsx(path = file.path(scope_path, "Survey Firm", "New_Lot_Karongi.xlsx"), sheet = "household list")
new_karongi_replacement <- read_xlsx(path = file.path(scope_path, "Survey Firm", "New_Lot_Karongi.xlsx"), sheet = "replacement_household")
lot_karongi_village <- read_xlsx(path = file.path(scope_path, "Readyboard by lot", "Lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_village <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "Lot_Karongi.xlsx"), sheet = "village list")
lot_karongi_household <- read_xlsx(path = file.path(scope_path,"EDCL",  "Readyboard by lot", "Lot_Karongi.xlsx"), sheet = "household list")
lot_karongi_replacement <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "Lot_Karongi.xlsx"), sheet = "replacement_household")
new_karongi_village <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "New_Lot_Karongi.xlsx"), sheet = "village list")
new_karongi_household <- read_xlsx(path = file.path(scope_path,"EDCL",  "Readyboard by lot", "New_Lot_Karongi.xlsx"), sheet = "household list")
identical(lot_karongi_village, new_karongi_village)
identical(lot_karongi_household, new_karongi_household)
lot_rutsiro_village <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "Lot_Rutsiro.xlsx"), sheet = "village list")
lot_rutsiro_household <- read_xlsx(path = file.path(scope_path,"EDCL",  "Readyboard by lot", "Lot_Rutsiro.xlsx"), sheet = "household list")
new_rutsiro_village <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "New_Lot_Rutsiro.xlsx"), sheet = "village list")
new_rutsiro_household <- read_xlsx(path = file.path(scope_path,"EDCL",  "Readyboard by lot", "New_Lot_Rutsiro.xlsx"), sheet = "household list")
identical(lot_rutsiro_village, new_rutsiro_village)
identical(lot_rutsiro_household, new_rutsiro_household)
pacman::p_load(knitr, tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr, RCT, purrr)
getwd()
hfc_complete <- hfc_constr %>%
filter(!is.na(A1_1))
View(hfc_complete)
table(hfc_complete$consent)
#Rulindo_2 villages----
rulindo_status1 <- read_xlsx(path = file.path(scope_path,"Rulindo_readyboard_status.xlsx"), sheet = "readyboard")
rulindo_status2 <- read_xlsx(path = file.path(scope_path,"Rulindo_readyboard_status.xlsx"), sheet = "non_readyboard")
rulindo_readyboard <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "Lot_Rulindo.xlsx"), sheet = "household list")
rulindo_2 <- rulindo_readyboard %>%
filter(
villageid_key %in% rulindo_status1$villageid_key
)
rulindo_status1 <- rulindo_status1 %>%
mutate(
status = "readyboard"
)
rulindo_status2 <- rulindo_status2 %>%
mutate(
status = "non_readyboard"
)
rulindo_status <- rbind(rulindo_status1, rulindo_status2)
rulindo_check <- rulindo_status1 %>%
filter(!nid %in% rulindo_2$nid)
View(rulindo_status1)
table(rulindo_status1$villageid_key)
village_check <- read_xlsx(path = file.path(scope_path, "HFC_REP_24 (1).xlsx"), sheet = "village_data")
View(village_check)
village_2 <- village_check %>%
filter(
villageid_key %in% rulindo_status1$villageid_key
)
View(village_2)
hfc_2 <- hfc_constr %>%
filter(
villageid_key %in% rulindo_status1$villageid_key
)
hfc_2 <- hfc_constr %>%
filter(
village %in% rulindo_status1$villageid_key
)
View(hfc_2)
View(rulindo_status)
View(rusizi2_household)
hfc_2 <- hfc_constr %>%
filter(
village %in% rulindo_status1$villageid_key
) %>%
left_join(rulindo_status, by = c("hh_id"))
View(rulindo_readyboard)
rulindo_readyboard <- read_xlsx(path = file.path(scope_path, "EDCL", "Readyboard by lot", "Lot_Rulindo.xlsx"), sheet = "household list")
four_scope_newly <- read_xlsx(path = file.path(scope_path, "scope_193_0807.xlsx"))
View(four_scope_newly)
rulindo_surveyfirm1 <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Rulindo.xlsx"), sheet = "household list")
rulindo_surveyfirm2 <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Rulindo.xlsx"), sheet = "replacement list")
rulindo_surveyfirm2 <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Rulindo.xlsx"), sheet = "replacement_list")
rulindo_surveyfirm2 <- read_xlsx(path = file.path(scope_path, "Survey Firm", "Lot_Rulindo.xlsx"), sheet = "replacement_household")
rulindo_surveyfirm <- rbind(rulindo_surveyfirm1, rulindo_surveyfirm2)
rulindo_surveyfirm <- rulindo_surveyfirm %>%
filter(villageid_key %in% rulindo_readyboard$villageid_key)
hfc_2 <- hfc_constr %>%
filter(
village %in% rulindo_status1$villageid_key
) %>%
left_join(rulindo_surveyfirm, by = c("hh_id"))
View(rulindo_surveyfirm)
hfc_2 <- hfc_constr %>%
filter(
village %in% rulindo_status1$villageid_key
) %>%
left_join(rulindo_surveyfirm, by = c("hh_id" = "household_id"))
rulindo_surveyfirm <- rulindo_surveyfirm %>%
filter(villageid_key %in% rulindo_readyboard$villageid_key) %>%
mutate(
household_id= as.numeric(household_id)
)
hfc_2 <- hfc_constr %>%
filter(
village %in% rulindo_status1$villageid_key
) %>%
left_join(rulindo_surveyfirm, by = c("hh_id" = "household_id"))
rulindo_check <- hfc_2%>%
filter(!village %in% rulindo_status1)
rulindo_check <- hfc_2%>%
filter(!village %in% rulindo_status1$villageid_key)
View(hfc_2)
rulindo_check <- hfc_2%>%
filter(!village.x %in% rulindo_status$villageid_key)
rulindo_check <- hfc_2%>%
filter(!nid %in% rulindo_status1$nid)
hfc_2 <- hfc_complete %>%
filter(
village %in% rulindo_status1$villageid_key
) %>%
left_join(rulindo_surveyfirm, by = c("hh_id" = "household_id"))
rulindo_check <- hfc_2%>%
filter(!nid %in% rulindo_status1$nid)
View(rulindo_check)
rulindo_check <- hfc_2%>%
filter(nid %in% rulindo_status1$nid)
rulindo_check <- hfc_2%>%
filter(!nid %in% rulindo_status1$nid)
rulindo_check <- hfc_2%>%
filter(nid %in% rulindo_status1$nid)
View(rulindo_check)
rulindo_status_check <- rulindo_status %>%
filter(villageid_key %in% rulindo_check$village.x)
View(rulindo_status_check)
rulindo_check <- hfc_2%>%
filter(!nid %in% rulindo_status1$nid)
rulindo_status_check <- rulindo_status %>%
filter(villageid_key %in% rulindo_check$village.x)
View(rulindo_status)
rulindo_status_check <- rulindo_status %>%
filter(nid %in% rulindo_check$nid)
View(admin_raw)
admin_readyboard <- admin_raw %>%
filter(
treatment== "T1" | treatment == "T3"
) %>%
group_by(district_key) %>%
summarise(
readyboard = sum(hh_head_06)
)
View(admin_readyboard)
admin_readyboard <- admin_raw %>%
filter(
treatment== "T1" | treatment == "T3"
) %>%
group_by(district_key) %>%
summarise(
readyboard = sum(hh_head_06),
village =n()
)
View(four_scope_newly)
four_scope_newly_readyboard <- four_scope_newly%>%
filter(
treatment== "T1" | treatment == "T3"
) %>%
group_by(district_key) %>%
summarise(
readyboard = sum(hh_head_06),
village =n()
)
four_scope_newly_readyboard <- four_scope_newly%>%
filter(
treat== "T1" | treat == "T3"
) %>%
group_by(district_key) %>%
summarise(
readyboard = sum(hh_head_06),
village =n()
)
four_scope_newly_readyboard <- four_scope_newly%>%
filter(
treat== "T1" | treat == "T3"
) %>%
group_by(district) %>%
summarise(
readyboard = sum(hh_head_06),
village =n()
)
View(four_scope_newly_readyboard)
four_scope_newly_readyboard <- four_scope_newly%>%
filter(
treat== "T1" | treat == "T3"
) %>%
group_by(lot) %>%
summarise(
readyboard = sum(hh_head_06),
village =n()
)
pacman::p_load(knitr, tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr, RCT, purrr)
getwd()
#Dropbox----
if (Sys.getenv("USERNAME") == "wb614406"){
DROPBOX <- file.path("C:/Users/wb614406/Dropbox")
}
data_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/data/data"
)
scope_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/data/Updated scope villages& households"
)
output_path <- file.path(
DROPBOX,
"Rwanda Energy/EAQIP/datawork/RCT_data",
"baseline/outputs"
)
