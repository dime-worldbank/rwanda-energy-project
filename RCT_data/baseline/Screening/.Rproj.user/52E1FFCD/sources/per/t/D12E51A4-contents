#Enumerator check----


screening_survey_enumerator <- screening_survey %>% 
  group_by(enumerator, enumerator_key) %>% 
  summarise(
    hh_screened = n(),
    hh_eligible = sum(status == "Eligible", na.rm = TRUE),
    hh_not_eligible = sum(status == "Not Eligible", na.rm = TRUE),
    hh_not_in_deployment_list = sum(status == "Not in Deployment List", na.rm = TRUE)
  ) %>% 
  ungroup() %>% 
  mutate(
    percent_eligible = paste0(round(hh_eligible / hh_screened * 100, 2), "%")
  )



##by date survey----

enumerator_survey_by_day <- screening_survey %>% 
  group_by(enumerator, startdate) %>% 
  summarise(
    hh_screened = n(),
    .groups = "drop"
  )

enumerator_survey_by_day_wide <- enumerator_survey_by_day %>%
  pivot_wider(
    names_from = startdate,
    values_from = hh_screened,
    values_fill = list(hh_screened = 0)  # Fill missing combinations with 0
  )

enumerator_check <- screening_survey_enumerator %>% 
  left_join(
    enumerator_survey_by_day_wide,
    by = c("enumerator" = "enumerator")
  ) %>% 
  select(
    enumerator, enumerator_key, hh_screened, hh_eligible,percent_eligible, hh_not_eligible, hh_not_in_deployment_list,  everything()
  )


hfc_sheet %>%
  
  sheet_write(data = enumerator_check, sheet = "Enumerator_check")


write_xlsx(enumerator_check , path = file.path(output_path, "enumerator_check_screening.xlsx"))
