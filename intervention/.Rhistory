rusizi_readyboard_village <- readyboard_village %>%
filter(district%in% c("Rusizi"))
rusizi1_customer <- st_read(dsn = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "shp", "REV1_RUSIZI_LOT_1_CUSTOMMERS.shp") )
rusizi1_customer <- st_transform(rusizi1_customer, crs = st_crs(rwa_village))
rusizi1_customer <- st_intersection(rusizi1_customer, rwa_village)
rusizi_dime <- scope_village %>%
filter(
district == "Rusizi"
)
rusizi1_customer_village <- rusizi1_customer %>%
group_by(Village_ID) %>%
summarise( n = n()) %>%
filter(n > 10)
rusizi2_customer <- st_read(dsn = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "shp", "Rusizi_LOT_2_Custommers_REV2.shp") )
rusizi2_customer <- st_transform(rusizi2_customer, crs = st_crs(rwa_village))
rusizi2_customer <- st_intersection(rusizi2_customer, rwa_village)
rusizi2_customer_village <- rusizi2_customer %>%
group_by(Village_ID) %>%
summarise( n = n()) %>%
filter(n > 10)
rusizi_customer_village <- rbind(rusizi1_customer_village, rusizi2_customer_village)
rusizi_discrepency <- rusizi_dime %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1)
View(rusizi_discrepency)
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(villageid_key %in% rusizi_customer_village$Village_ID)
View(rusizi_epc_discrepency)
rusizi_readyboard_village <- readyboard_village %>%
filter(district%in% c("Rusizi"), .keep_all = TRUE)
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(villageid_key %in% rusizi_customer_village$Village_ID)
write_xlsx(rusizi_discrepency, path = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "rusizi_epc_discrepency.xlsx"))
View(rusizi_readyboard_village)
readyboard_village <- master %>%
group_by(villageid_key, district, sector, cell, village) %>%
summarise( n = sum(readyboard)) %>%
filter( n >0 )
rusizi_readyboard_village <- readyboard_village %>%
filter(district%in% c("Rusizi"), .keep_all = TRUE)
write_xlsx(rusizi_discrepency, path = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "rusizi_epc_discrepency.xlsx"))
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(villageid_key %in% rusizi_customer_village$Village_ID)
write_xlsx(rusizi_discrepency, path = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "rusizi_epc_discrepency.xlsx"))
rusizi_village <- scope_village %>%
filter(district %in% c("Rusizi"))
View(rusizi_village)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1)
View(rusizi_discrepency)
rusizi_discrepency <- rusizi_village %>%
filter(village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(villageid_key %in% rusizi_customer_village$Village_ID)
write_xlsx(
list(
"EPC not in GIS list" = rusizi_epc_discrepency,
"Scope village dropped" = rusizi_discrepency
),
path = file.path(
data_path_2,
"Readyboard EPC negotiation",
"Rusizi",
"rusizi_scope_discrepency.xlsx"
)
)
rusizi_discrepency <- rusizi_village %>%
filter(village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
table(rusizi_discrepency$treat)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
table(rusizi_discrepency$treat)
##Lot 1=======
rusizi1_customer <- st_read(dsn = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "shp", "REV1_RUSIZI_LOT_1_CUSTOMMERS.shp") )
rusizi1_customer <- st_transform(rusizi1_customer, crs = st_crs(rwa_village))
rusizi1_customer <- st_intersection(rusizi1_customer, rwa_village)
rusizi_dime <- scope_village %>%
filter(
district == "Rusizi"
)
rusizi1_customer_village <- rusizi1_customer %>%
group_by(Village_ID) %>%
summarise( n = n())
##Lot 2-------
rusizi2_customer <- st_read(dsn = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "shp", "Rusizi_LOT_2_Custommers_REV2.shp") )
rusizi2_customer <- st_transform(rusizi2_customer, crs = st_crs(rwa_village))
rusizi2_customer <- st_intersection(rusizi2_customer, rwa_village)
rusizi2_customer_village <- rusizi2_customer %>%
group_by(Village_ID) %>%
summarise( n = n())
rusizi_customer_village <- rbind(rusizi1_customer_village, rusizi2_customer_village)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
rusizi_in_scope <- rusizi_village %>%
filter(village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
rusizi_discrepency <- rusizi_village %>%
filter(!village_id %in% rusizi_customer_village$Village_ID) %>%
select(village_id, province, district, lot, sector, cell, name, scope_2407, ubudehe_1, treat)
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(villageid_key %in% rusizi_customer_village$Village_ID)
write_xlsx(
list(
"Scope village keeped" = rusizi_in_scope,
"Scope village dropped" = rusizi_discrepency,
"EPC not in GIS list" = rusizi_epc_discrepency,
),
path = file.path(
data_path_2,
"Readyboard EPC negotiation",
"Rusizi",
"rusizi_scope_discrepency.xlsx"
)
)
write_xlsx(
list(
"Scope village keeped" = rusizi_in_scope,
"Scope village dropped" = rusizi_discrepency,
"EPC not in GIS list" = rusizi_epc_discrepency
),
path = file.path(
data_path_2,
"Readyboard EPC negotiation",
"Rusizi",
"rusizi_scope_discrepency.xlsx"
)
)
write_xlsx(rusizi_discrepency, path = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "rusizi_epc_discrepency.xlsx"))
rusizi_epc_discrepency <- rusizi_readyboard_village %>%
filter(!villageid_key %in% rusizi_customer_village$Village_ID)
View(rusizi_epc_discrepency)
write_xlsx(
list(
"Scope village keeped" = rusizi_in_scope,
"Scope village dropped" = rusizi_discrepency,
"EPC not in GIS list" = rusizi_epc_discrepency
),
path = file.path(
data_path_2,
"Readyboard EPC negotiation",
"Rusizi",
"rusizi_scope_discrepency.xlsx"
)
)
View(rusizi2_dime_village)
View(rusizi_village)
View(scope_village)
# Import Data ----
dropbox <- 'C:/Users/wb614406/Dropbox'
output_path <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/baseline analysis/output"
)
data_path_1 <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data"
)
hfc_path <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/HFC/data"
)
data_path_2 <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/Updated scope villages& households"
)
#Complete-----
complete  <- read_xlsx(path = file.path(data_path_2, "survey status of vulnerable households in sample villages_final.xlsx"))
pacman::p_load(knitr, stargazer, tidyverse, dplyr, here, sf, ggplot2, readxl, writexl, janitor, randomizr, RCT, purrr, lfe, install = TRUE)
library(googlesheets4)
getwd()
# Import Data ----
dropbox <- 'C:/Users/wb614406/Dropbox'
output_path <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/baseline analysis/output"
)
data_path_1 <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data"
)
hfc_path <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/HFC/data"
)
data_path_2 <- file.path(
dropbox,
"Rwanda Energy/EAQIP/datawork/RCT_data/baseline/data/Updated scope villages& households"
)
#Complete-----
complete  <- read_xlsx(path = file.path(data_path_2, "survey status of vulnerable households in sample villages_final.xlsx"))
complete_survey <- complete %>%
filter(`Completed by Lattanzio` == "Yes")
treatment_raw <- read_xlsx(path = file.path(data_path_2, "scope_193_0807.xlsx"))
View(treatment)
treatment <- read_xlsx(path = file.path(data_path_2, "scope_193_0807.xlsx")) %>%
select(village_id, treat) %>%
filter(treat %in% c("T1", "T3"))
complete_krr <- complete %>%
mutate(across(c(district, sector, cell, village), ~ str_to_title(.))) %>%
filter(villageid_key %in% treatment$village_id) %>%
mutate(key = paste0(first_name, last_name, nid))
## Rulindo----
rulindo_epc_6 <- read_xlsx(path = file.path(data_path_2, "Readyboard EPC negotiation", "Beneficiary List of Rulindo.xlsx"))
rulindo_epc_6 <- rulindo_epc_6 %>%
mutate(
nid = ifelse(nid == "1198780122610117,", "1198980075181012", nid)
) %>%
mutate(readyboard = ifelse(is.na(scope), 1, 0)) %>%
rename(comment = scope) %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
rulindo_epc_7 <- read_xlsx(path = file.path(data_path_2, "Readyboard EPC negotiation", "Rulindo_7.xlsx"))
rulindo_epc_7 <- rulindo_epc_7 %>%
clean_names() %>%
rename(comment = comments) %>%
mutate(readyboard = 1) %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
rulindo_epc <- rbind(rulindo_epc_6, rulindo_epc_7) %>%
distinct(nid, .keep_all = TRUE)
##Karongi----
karongi_epc <- read_xlsx(path = file.path(data_path_2, "Readyboard EPC negotiation", "Copy of EPC-KARONGI-REDBOARD-CUSTOMER-LISTE-9.xlsx"), sheet = "EPC-KARONGI-CUSTO-REDBOARD") %>%
mutate(readyboard = 1,
comment = NA) %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
##Rutsiro=====
# rutsiro_epc<- read_xlsx(path = file.path(data_path_2, "Readyboard EPC negotiation", "EPC-RUTSIRO- REDBOARD-CUSTOMER-LISTE.xlsx"), sheet = "RUTSIRO-LOT1-REDBOARD") %>%
#   mutate(readyboard = 1,
#          comment = NA) %>%
#   select(
#     villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
#   )
rutsiro_epc <- read_xlsx(
path = file.path(data_path_2, "Readyboard EPC negotiation", "Beneficiary List of Rutsiro.xlsx"),
sheet = "new list"
) %>%
clean_names() %>%
mutate(
across(everything(), str_to_title),  # Apply Title Case to all columns
readyboard = ifelse(
str_to_lower(comment) %in% c("available", "within scope"),  1,  0)
) %>%
select(
villageid_key, village, cell, sector, district,
first_name, last_name, gender, nid, readyboard, comment
)
sum(rutsiro_epc$readyboard == 1)
n_distinct(rutsiro_epc$villageid_key)
nrow(rutsiro_epc)
check <- rutsiro_epc %>%
filter(!nid %in% rutsiro_dime$nid)
##Rusizi----
rusizi1_epc_scope <- read_xlsx(
path = file.path(data_path_2, "Readyboard EPC negotiation", "Beneficiary List of Rusizi_1 (Final).xlsx"),
sheet = "Within scope"
) %>%
mutate(
readyboard = ifelse(`Status 1` %in% c("Available", "available"), 1, 0),
comment    = ifelse(`Status 1` %in% c("Available", "available"), "Within scope", "Outside of scope")
) %>%
select(
villageid_key, village, cell, sector, district,
first_name, last_name, gender, nid,
readyboard, comment
)
rusizi1_epc_noscope <- read_xlsx(path = file.path(data_path_2, "Readyboard EPC negotiation", "Beneficiary List of Rusizi_1 (Final).xlsx"), sheet = "Outside of scope") %>%
mutate(readyboard = 0,
comment = "Outside of scope") %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
rusizi1_epc <- rbind(rusizi1_epc_scope, rusizi1_epc_noscope)
rusizi2_epc_scope <- read_xlsx(path = file.path(data_path_2,"Readyboard EPC negotiation",  "Beneficiary List of Rusizi_2 (Final).xlsx"), sheet = "Within scope") %>%
mutate(readyboard = ifelse(`Status` == "Available", 1, 0),
comment = ifelse(`Status` == "Available", "Within scope", "Outside of scope")) %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
rusizi2_epc_noscope <- read_xlsx(path = file.path(data_path_2,"Readyboard EPC negotiation",  "Beneficiary List of Rusizi_2 (Final).xlsx"), sheet = "Outside of scope") %>%
mutate(readyboard = 0,
comment = "Outside of scope") %>%
select(
villageid_key, village, cell, sector, district, first_name, last_name, gender, nid, readyboard, comment
)
rusizi2_epc <- rbind(rusizi2_epc_scope, rusizi2_epc_noscope)
epc_join <- rbind(karongi_epc, rulindo_epc, rutsiro_epc, rusizi1_epc, rusizi2_epc) %>%
mutate(
key = paste0(first_name, last_name, nid),
nid_epc = nid
) %>%
select(key, readyboard, comment, nid_epc) %>%
left_join(complete_krr, epc_join, by = c("key" = "key")) %>%
mutate(
household_id = case_when(
nid_epc == "1195970047063046" ~ "411001060384",
nid_epc == "1198870126907080" ~ "411001060519",
nid_epc == "1198180147332076" ~ "411502040210",
TRUE ~ household_id
)
) %>%
distinct(household_id, .keep_all = TRUE) %>%
select(
household_id, readyboard, comment
)
master <- full_join(complete_krr, epc_join)
dupes <- master %>%
filter(duplicated(key) | duplicated(key, fromLast = TRUE))
master <- master %>%
distinct(key, .keep_all = TRUE)
#Analysis-------
master <- master %>%
filter(`Dropped from scope due to 15kv` == "No") %>%
mutate(readyboard = ifelse(is.na(readyboard), 0, readyboard)) %>%
mutate(
vulnerable = 1
) %>%
mutate(
lot = ifelse(villageid_key %in% rusizi1_dime_village$village_id, "Rusizi-1",
ifelse(villageid_key %in% rusizi2_dime_village$village_id, "Rusizi-2", district))
)
master <- master %>%
mutate(
surveyed = ifelse(household_id %in% complete_survey$household_id, 1, 0)
) %>%
mutate(
vulnerable = 1
)
master_readyboard <- master %>%
group_by(villageid_key) %>%
filter(any(readyboard == 1, na.rm = TRUE)) %>%  # keep only villages with at least one readyboard
ungroup() %>%
group_by(lot) %>%
summarise(
n         = n(),                               # total rows in this lot after the filter
n_readyboard = sum(readyboard == 1, na.rm = TRUE),
village   = n_distinct(villageid_key),         # unique villages per lot
n_surveyed = sum(surveyed == 1, na.rm = TRUE), # count of complete == 1 per lot
n_surveyed_readyboard = sum(surveyed == 1 & readyboard == 1, na.rm = TRUE),
.groups = "drop"
)
analysis <- master %>% count(lot, readyboard, surveyed)
table(rulindo_7$name)
table(rulindo_epc_7$village)
rusizi1_epc_scope <- read_xlsx(
path = file.path(data_path_2, "Readyboard EPC negotiation", "Beneficiary List of Rusizi_1 (Final).xlsx"),
sheet = "Within scope"
) %>%
mutate(
readyboard = ifelse(`Status 1` %in% c("Available", "available"), 1, 0),
comment    = ifelse(`Status 1` %in% c("Available", "available"), "Within scope", "Outside of scope")
) %>%
select(
villageid_key, village, cell, sector, district,
first_name, last_name, gender, nid,
readyboard, comment
)
rusizi1_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 1")  %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1197270035899039", "1197270035896039", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed)
dup_df.1 <- tibble(duplicate_id = rusizi1_installed$installed_id[duplicated(rusizi1_installed$installed_id)])
dup_df.1 <- rusizi1_installed %>%
filter(installed_id %in% dup_df.1$duplicate_id)
dup_df.1 <- tibble(duplicate_id = rusizi1_installed$installed_id[duplicated(rusizi1_installed$installed_id)])
rusizi1_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 1")  %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1197270035899039", "1197270035896039", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed)
View(rusizi1_installed)
rusizi1_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 1")  %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1197270035899039", "1197270035896039", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed, installed_id)
dup_df.1 <- tibble(duplicate_id = rusizi1_installed$installed_id[duplicated(rusizi1_installed$installed_id)])
dup_df.1 <- rusizi1_installed %>%
filter(installed_id %in% dup_df.1$duplicate_id)
check <- rusizi1_epc_scope %>%
filter(nid %in% rusizi1_installed$id)
check.1 <- rusizi1_epc_scope %>%
filter(villageid_key %in% check$villageid_key)
check <- rusizi1_epc_scope %>%
filter(nid %in% rusizi1_installed$installed_id)
check <- rusizi1_epc_scope %>%
filter(!nid %in% rusizi1_installed$installed_id)
check <- rusizi1_installed %>%
filter(!nid %in% rusizi1_dime$nid)
check <- rusizi1_installed %>%
filter(nid %in% rusizi1_dime$nid)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")  %>%
clean_names() %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed, installed_id)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")  %>%
clean_names() %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(installed, installed_id)
dup_df.2 <- tibble(duplicate_id = rusizi2_installed$installed_id[duplicated(rusizi2_installed$installed_id)])
dup_df.2 <- rusizi2_installed %>%
filter(installed_id %in% dup_df.2$duplicate_id)
dup_df.2 <- rusizi2_installed %>%
filter(installed_id %in% dup_df.2$duplicate_id)
check <- rusizi2_installed %>%
filter(!nid %in% rusizi2_dime$nid)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")  %>%
clean_names() %>%
mutate(
nid = id
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed, installed_id)
dup_df.2 <- tibble(duplicate_id = rusizi2_installed$installed_id[duplicated(rusizi2_installed$installed_id)])
dup_df.2 <- rusizi2_installed %>%
filter(installed_id %in% dup_df.2$duplicate_id)
#
# write_xlsx(
#   dup_df.2,
#   path = file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi", "Duplicate in Rusizi Lot1 readyboard recipient.xlsx")
# )
check <- rusizi2_installed %>%
filter(!nid %in% rusizi2_dime$nid)
check <- rusizi2_installed %>%
filter(!nid %in% rusizi2_dime$nid)
View(check)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")
View(rusizi2_installed)
View(rusizi2_dime)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")
clean_names() %>%
mutate(
nid = ifelse(id == "1195770018361066", "12630104", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed, installed_id)
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")   %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1195770018361066", "12630104", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(nid, installed, installed_id)
dup_df.2 <- tibble(duplicate_id = rusizi2_installed$installed_id[duplicated(rusizi2_installed$installed_id)])
dup_df.2 <- rusizi2_installed %>%
filter(installed_id %in% dup_df.2$duplicate_id)
check <- rusizi2_installed %>%
filter(!nid %in% rusizi2_dime$nid)
rusizi_installed <- rbind(rusizi1_installed, rusizi2_installed)
#
#   filter(!is.na(nid)) %>%
#   distinct(nid, .keep_all = TRUE)
View(rusizi_installed)
master_installed <- left_join(master, rusizi_installed)
write_xlsx(master_installed, path = file.path(data_path_2, "Readyboard EPC negotiation", "master_installed.xlsx"))
rusizi2_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 2")   %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1195770018361066", "12630104", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(village_id, nid, installed, installed_id)
rusizi1_installed <- read_xlsx(path =file.path(data_path_2, "Readyboard EPC negotiation", "Rusizi_installed.xlsx" ), sheet = "lot 1")  %>%
clean_names() %>%
mutate(
nid = ifelse(id == "1197270035899039", "1197270035896039", id)
) %>%
rename(installed_id = id) %>%
mutate(installed = 1 ) %>%
select(village_id, nid, installed, installed_id)
rusizi_installed <- rbind(rusizi1_installed, rusizi2_installed)
rusizi_installed_join <- rusizi_installed %>%
select(-village_id)
rusizi_installed <- rbind(rusizi1_installed, rusizi2_installed)
rusizi_installed_join <- rusizi_installed %>%
select(-village_id)
master_installed <- left_join(master, rusizi_installed_join)
write_xlsx(master_installed, path = file.path(data_path_2, "Readyboard EPC negotiation", "master_installed.xlsx"))
table(rusizi_installed$village_id)
